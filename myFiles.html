<!DOCTYPE html>
<html>
<head>
	<link rel="stylesheet" type="text/css" href="style.css">
	<title>MyFiles</title>
</head>
<body>

<ul class="navbar">
	<li class="navbar"><a href="index.html" class="scale_transition home navbar">Home</a></li>
	<li class="navbar"><a href="index.html" class="scale_transition logout navbar">Logout</a></li>
</ul>

<div align="left" class="myfiles"><p>Uploaded Files</p>
	<button class="options_button">Viewing Options</button>
	<div class="options" id="Options">
		<input type="checkbox" name="check" onchange="sortListBySize();unCheck(this)"/> Order documents by size
		<input type="checkbox" name="check" onchange="unCheck(this);sortListByDate()"/>Order Files By Date
		<input type="checkbox" name="check" onchange="sortListAlphabetically();unCheck(this)"/> Order documents alphabetically
		<br>
		<input type="text" id="searchInput" class="search_field" onkeyup="Search()" placeholder="Search for files..">

	</div>
<ul id="fileslist" class="myfiles">
</ul>
</div>

<div class="upload">
<p>Introdu numele fisierului pe care doresti sa-l adaugi:</p>
<form id="uploadform">
Choose the file you wish to upload:<input type="file" id="myFile">
<input type="button" onclick="uploadFile()" value="Upload" class="scale_transition ">
</form>
</div>

<script>
	function uploadFile()
	{
		var file=document.getElementById("myFile");
		if(typeof(file)!= 'undefined' || file!=null){
			var Name="";
			var Size="";
			var Type="";
			var ul=document.getElementById("fileslist");
			var li=document.createElement("li");
			var div=document.createElement("div");
			var pSize=document.createElement("p");	
            var pType=document.createElement("p");
			var downloadButton=document.createElement("button");
			var	deleteButton=document.createElement("button");
			var pUploadDate=document.createElement("p");
		
		for (var index=0;index<file.files.length;index++){
			var fileAttributes=file.files[index];
			if('name' in fileAttributes){
				Name +=fileAttributes.name;
			}
			if('size' in fileAttributes){
				Size +="Size:" + fileAttributes.size + " bytes";
			}
			if('type' in fileAttributes){
				 Type+="Type:" + fileAttributes.type;
			}
		}
		li.appendChild(document.createTextNode(Name));
		deleteButton.setAttribute("class","delete_button");
		deleteButton.setAttribute("onclick","deleteElement(this)");
		li.appendChild(deleteButton);
		li.setAttribute("class","myfiles scale_transition");
		div.setAttribute("class","detalii myfiles");
		downloadButton.setAttribute("class","download_button");
		downloadButton.appendChild(document.createTextNode("Download"));
		pSize.appendChild(document.createTextNode("> "+Size));
		pType.appendChild(document.createTextNode("> "+Type));
		pUploadDate.appendChild(document.createTextNode("> Uploaded at:"+new Date().toString().split(' ').splice(1,4).join(',')));
		pSize.setAttribute("class","detalii");
		pType.setAttribute("class","detalii");
		pUploadDate.setAttribute("class","detalii");
		div.appendChild(pSize);
		div.appendChild(pType);
		div.appendChild(pUploadDate);
		div.appendChild(downloadButton);
		li.appendChild(div);
		ul.appendChild(li);
	}
	}

	function sortListBySize(){
		var list,index,switching,li,shouldSwitch,dir,switchCount=0;
		list=document.getElementById("fileslist");
		switching=true;
		dir="asc";
		while(switching){
			switching=false;
			li=list.getElementsByTagName("li");
			for(index=0;index<(li.length-1);index++){
				size1=(((li[index]).childNodes[2]).childNodes[0]).innerHTML;
				size2=(((li[index+1]).childNodes[2]).childNodes[0]).innerHTML;
				shouldSwitch=false;

				if(dir=="asc"){
					if(size1>size2){
						shouldSwitch=true;
						break;
					}
				}
				else{
					if(dir=="desc"){
						if(size1<size2){
							shouldSwitch=true;
							break;
						}
					}
				}
			}
			if (shouldSwitch){
				li[index].parentNode.insertBefore(li[index+1],li[index]);
				switching=true;
				switchCount++;
			}
			else{
				if(switchCount==0 && dir=="asc"){
					dir="desc";
					switching=true;
				}
			}
		}
	}

	function sortListByDate(){
		var list,index,switching,li,shouldSwitch,dir,switchCount=0;
		list=document.getElementById("fileslist");
		switching=true;
		dir="asc";
		while(switching){
			switching=false;
			li=list.getElementsByTagName("li");
			for(index=0;index<(li.length-1);index++){
				size1=(((li[index]).childNodes[2]).childNodes[2]).innerHTML;
				size2=(((li[index+1]).childNodes[2]).childNodes[2]).innerHTML;
				shouldSwitch=false;

				if(dir=="asc"){
					if(size1>size2){
						shouldSwitch=true;
						break;
					}
				}
				else{
					if(dir=="desc"){
						if(size1<size2){
							shouldSwitch=true;
							break;
						}
					}
				}
			}
			if (shouldSwitch){
				li[index].parentNode.insertBefore(li[index+1],li[index]);
				switching=true;
				switchCount++;
			}
			else{
				if(switchCount==0 && dir=="asc"){
					dir="desc";
					switching=true;
				}
			}
		}
	}

	function sortListAlphabetically(){
		var list,index,switching,li,shouldSwitch,dir,switchCount=0;
		list=document.getElementById("fileslist");
		switching=true;
		dir="asc";
		while(switching){
			switching=false;
			li=list.getElementsByTagName("li");
			for(index=0;index<(li.length-1);index++){
				size1=(li[index]).innerHTML;
				size2=(li[index+1]).innerHTML;
				shouldSwitch=false;

				if(dir=="asc"){
					if(size1>size2){
						shouldSwitch=true;
						break;
					}
				}
				else{
					if(dir=="desc"){
						if(size1<size2){
							shouldSwitch=true;
							break;
						}
					}
				}
			}
			if (shouldSwitch){
				li[index].parentNode.insertBefore(li[index+1],li[index]);
				switching=true;
				switchCount++;
			}
			else{
				if(switchCount==0 && dir=="asc"){
					dir="desc";
					switching=true;
				}
			}
		}
	}

	function unCheck(e){
		var checkboxes=document.getElementsByName("check");
		for(var index=0;index<checkboxes.length;index++){
			checkboxes[index].checked=false;
		}
		e.checked=true;
	}

	function Search()
{
var searchInput,ul,li,filename,i,txtValue;

searchInput=(document.getElementById("searchInput")).value.toUpperCase();
ul=document.getElementById("fileslist");
li=ul.getElementsByTagName("li");

for(i=0;i<li.length;i++)

if((li[i].innerText).toUpperCase().indexOf(searchInput) > -1)
	li[i].style.display="";
else
	li[i].style.display="none";
}

function deleteElement(e)
{
	var li=e.parentNode;
	li.remove();
}

</script>
</body>
</html>